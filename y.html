<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Devil Fruit Image Fetcher</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        const DevilFruitFetcher = () => {
            const [loading, setLoading] = useState(false);
            const [progress, setProgress] = useState({ current: 0, total: 0 });
            const [updatedFruits, setUpdatedFruits] = useState([]);

            const devilFruits = [
                { name: "Gomu Gomu no Mi", type: "Paramecia", user: "Monkey D. Luffy" },
                { name: "Mera Mera no Mi", type: "Logia", user: "Portgas D. Ace" },
                { name: "Hie Hie no Mi", type: "Logia", user: "Kuzan" },
                { name: "Yami Yami no Mi", type: "Logia", user: "Marshall D. Teach" },
                { name: "Gura Gura no Mi", type: "Paramecia", user: "Edward Newgate" },
                { name: "Ope Ope no Mi", type: "Paramecia", user: "Trafalgar D. Water Law" },
                { name: "Pika Pika no Mi", type: "Logia", user: "Borsalino" },
                { name: "Magu Magu no Mi", type: "Logia", user: "Sakazuki" },
                { name: "Hana Hana no Mi", type: "Paramecia", user: "Nico Robin" },
                { name: "Nikyu Nikyu no Mi", type: "Paramecia", user: "Bartholomew Kuma" },
                { name: "Suna Suna no Mi", type: "Logia", user: "Crocodile" },
                { name: "Goro Goro no Mi", type: "Logia", user: "Enel" },
                { name: "Mochi Mochi no Mi", type: "Special Paramecia", user: "Charlotte Katakuri" },
                { name: "Bara Bara no Mi", type: "Paramecia", user: "Buggy" },
                { name: "Horo Horo no Mi", type: "Paramecia", user: "Perona" },
                { name: "Mero Mero no Mi", type: "Paramecia", user: "Boa Hancock" },
                { name: "Soru Soru no Mi", type: "Paramecia", user: "Big Mom" },
                { name: "Ito Ito no Mi", type: "Paramecia", user: "Donquixote Doflamingo" },
                { name: "Hobi Hobi no Mi", type: "Paramecia", user: "Sugar" },
                { name: "Doru Doru no Mi", type: "Paramecia", user: "Mr. 3" },
                { name: "Bari Bari no Mi", type: "Paramecia", user: "Bartolomeo" },
                { name: "Phoenix Fruit", type: "Mythical Zoan", user: "Marco" },
                { name: "Zou Zou no Mi Model Mammoth", type: "Ancient Zoan", user: "Jack" },
                { name: "Uo Uo no Mi Model Seiryu", type: "Mythical Zoan", user: "Kaido" },
                { name: "Hito Hito no Mi Model Daibutsu", type: "Mythical Zoan", user: "Sengoku" },
                { name: "Suke Suke no Mi", type: "Paramecia", user: "Absalom" },
                { name: "Kage Kage no Mi", type: "Paramecia", user: "Gecko Moria" },
                { name: "Moku Moku no Mi", type: "Logia", user: "Smoker" },
                { name: "Gasu Gasu no Mi", type: "Logia", user: "Caesar Clown" },
                { name: "Yuki Yuki no Mi", type: "Logia", user: "Monet" },
                { name: "Hoya Hoya no Mi", type: "Paramecia", user: "Charlotte Daifuku" },
                { name: "Bisu Bisu no Mi", type: "Paramecia", user: "Charlotte Cracker" },
                { name: "Memo Memo no Mi", type: "Paramecia", user: "Charlotte Pudding" },
                { name: "Zushi Zushi no Mi", type: "Paramecia", user: "Fujitora" },
                { name: "Kira Kira no Mi", type: "Paramecia", user: "Jozu" }
            ];

            const searchFruitImage = async (fruitName) => {
                try {
                    const searchQuery = `${fruitName} one piece devil fruit`;
                    const response = await fetch(
                        `https://api.rawg.io/api/games?key=e42e6491d7524cd693ecb354dd22aa08&search=${encodeURIComponent(searchQuery)}&page_size=1`
                    );
                    const data = await response.json();
                    
                    if (data.results && data.results.length > 0) {
                        return data.results[0].background_image || null;
                    }
                    return null;
                } catch (error) {
                    console.error(`Error fetching image for ${fruitName}:`, error);
                    return null;
                }
            };

            const fetchAllImages = async () => {
                setLoading(true);
                setUpdatedFruits([]);
                setProgress({ current: 0, total: devilFruits.length });

                const results = [];
                
                for (let i = 0; i < devilFruits.length; i++) {
                    const fruit = devilFruits[i];
                    const image = await searchFruitImage(fruit.name);
                    
                    results.push({
                        ...fruit,
                        image: image || 'https://via.placeholder.com/400x500/8B5CF6/FFFFFF?text=Devil+Fruit'
                    });
                    
                    setProgress({ current: i + 1, total: devilFruits.length });
                    setUpdatedFruits([...results]);
                    
                    await new Promise(resolve => setTimeout(resolve, 500));
                }

                setLoading(false);
            };

            const downloadJSON = () => {
                const jsonData = {
                    fruits: updatedFruits
                };
                
                const blob = new Blob([JSON.stringify(jsonData, null, 2)], { 
                    type: 'application/json' 
                });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = 'devil_fruits_updated.json';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            useEffect(() => {
                setUpdatedFruits(devilFruits.map(f => ({ ...f, image: null })));
            }, []);

            const getTypeColor = (type) => {
                if (type.includes('Logia')) return 'bg-blue-500';
                if (type.includes('Zoan')) return 'bg-orange-500';
                return 'bg-purple-500';
            };

            return (
                <div className="min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900 p-8">
                    <div className="max-w-7xl mx-auto">
                        <h1 className="text-5xl font-bold text-white mb-4 text-center">
                            üçé Devil Fruit Database
                        </h1>
                        <p className="text-purple-300 text-center mb-8">35 Most Popular Devil Fruits from One Piece</p>

                        <div className="bg-white/10 backdrop-blur-lg rounded-xl p-6 mb-8">
                            <div className="flex flex-wrap gap-4 items-center justify-between">
                                <div className="text-white">
                                    <p className="font-semibold">Total Fruits: {devilFruits.length}</p>
                                </div>

                                <div className="flex gap-4">
                                    <button
                                        onClick={fetchAllImages}
                                        disabled={loading}
                                        className="px-6 py-2 bg-purple-600 hover:bg-purple-700 disabled:bg-gray-600 text-white rounded-lg font-semibold flex items-center gap-2 transition"
                                    >
                                        <span>{loading ? '‚ü≥' : '‚Üª'}</span>
                                        {loading ? 'Fetching...' : 'Fetch Images'}
                                    </button>

                                    {updatedFruits.length > 0 && !loading && updatedFruits[0].image && (
                                        <button
                                            onClick={downloadJSON}
                                            className="px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg font-semibold flex items-center gap-2 transition"
                                        >
                                            <span>‚¨á</span>
                                            Download JSON
                                        </button>
                                    )}
                                </div>
                            </div>

                            {loading && (
                                <div className="mt-4">
                                    <div className="w-full bg-gray-700 rounded-full h-4">
                                        <div
                                            className="bg-purple-600 h-4 rounded-full transition-all duration-300"
                                            style={{ width: `${(progress.current / progress.total) * 100}%` }}
                                        />
                                    </div>
                                    <p className="text-white text-center mt-2">
                                        {progress.current} / {progress.total} fruits processed
                                    </p>
                                </div>
                            )}
                        </div>

                        <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-5 gap-6">
                            {updatedFruits.map((fruit, index) => (
                                <div
                                    key={index}
                                    className="bg-white/10 backdrop-blur-lg rounded-lg overflow-hidden hover:transform hover:scale-105 transition-all duration-300 relative"
                                >
                                    <div className="aspect-[3/4] bg-gradient-to-br from-purple-900 to-slate-900 flex items-center justify-center relative overflow-hidden">
                                        {fruit.image ? (
                                            <>
                                                <img
                                                    src={fruit.image}
                                                    alt={fruit.name}
                                                    className="w-full h-full object-cover opacity-70"
                                                    onError={(e) => {
                                                        e.target.src = 'https://via.placeholder.com/400x500/8B5CF6/FFFFFF?text=Devil+Fruit';
                                                    }}
                                                />
                                                <div className="absolute inset-0 bg-gradient-to-t from-black/80 via-transparent to-transparent"></div>
                                                <div className="absolute bottom-0 left-0 right-0 p-3">
                                                    <h3 className="text-white font-bold text-sm text-center drop-shadow-lg">
                                                        {fruit.name}
                                                    </h3>
                                                </div>
                                            </>
                                        ) : (
                                            <div className="text-center p-4">
                                                <div className="text-purple-300 text-5xl mb-2">üçé</div>
                                                <p className="text-white text-sm font-bold">{fruit.name}</p>
                                            </div>
                                        )}
                                    </div>
                                    <div className="p-3">
                                        <div className="flex items-center justify-between mb-1">
                                            <span className={`${getTypeColor(fruit.type)} text-white text-xs px-2 py-1 rounded-full font-semibold`}>
                                                {fruit.type}
                                            </span>
                                        </div>
                                        <p className="text-purple-200 text-xs">
                                            User: <span className="text-white font-semibold">{fruit.user}</span>
                                        </p>
                                    </div>
                                </div>
                            ))}
                        </div>
                    </div>
                </div>
            );
        };

        ReactDOM.render(<DevilFruitFetcher />, document.getElementById('root'));
    </script>
</body>
</html>